import"./vendor.f533a68a.js";/* empty css             *//* empty css               *//* empty css              */import{_ as e,r as a,v as r,g as t,o,c as l,w as n,a as i,f as s,q as c,s as d,K as u,h as p,i as g,l as m,j as y,L as f,x as v,d as b,U as _,e as h,M as k,N as C,O as x,P as w,E as I,R as F,S as j,T as L}from"./index.08d2378a.js";/* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const S={class:"dialog-footer"};var V=e({__name:"DialogAddCategory",props:{type:String,reload:Function},setup(e,{expose:v}){const b=e,_=a(null),h=r(),k=t({visible:!1,categoryLevel:1,parentId:0,ruleForm:{name:"",rank:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],rank:[{required:"true",message:"编号不能为空",trigger:["change"]}]},id:""}),C=()=>{_.value.validate((e=>{e&&("add"==b.type?d.post("/categories",{categoryLevel:k.categoryLevel,parentId:k.parentId,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("添加成功"),k.visible=!1,b.reload&&b.reload()})):d.put("/categories",{categoryId:k.id,categoryLevel:k.categoryLevel,parentId:k.categoryLevel,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("修改成功"),k.visible=!1,b.reload&&b.reload()})))}))};return v({open:e=>{if(k.visible=!0,e)k.id=e,(e=>{d.get(`/categories/${e}`).then((e=>{k.ruleForm={name:e.categoryName,rank:e.categoryRank},k.parentId=e.parentId,k.categoryLevel=e.categoryLevel}))})(e);else{const{level:e=1,parent_id:a=0}=h.query;k.ruleForm={name:"",rank:""},k.parentId=a,k.categoryLevel=e}},close:()=>{k.visible=!1}}),(e,a)=>{const r=p,t=g,d=m,u=y,v=f;return o(),l(v,{title:"add"==k.type?"添加分类":"修改分类",modelValue:k.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>k.visible=e),width:"400px"},{footer:n((()=>[i("span",S,[s(u,{onClick:a[2]||(a[2]=e=>k.visible=!1)},{default:n((()=>[c("取 消")])),_:1}),s(u,{type:"primary",onClick:C},{default:n((()=>[c("确 定")])),_:1})])])),default:n((()=>[s(d,{model:k.ruleForm,rules:k.rules,ref_key:"formRef",ref:_,"label-width":"100px",class:"good-form"},{default:n((()=>[s(t,{label:"商品名称",prop:"name"},{default:n((()=>[s(r,{type:"text",modelValue:k.ruleForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>k.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),s(t,{label:"排序值",prop:"rank"},{default:n((()=>[s(r,{type:"number",modelValue:k.ruleForm.rank,"onUpdate:modelValue":a[1]||(a[1]=e=>k.ruleForm.rank=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},[["__file","/Users/gaobin/Downloads/vue3-admin-main/src/components/DialogAddCategory.vue"]]);const z={class:"header"},D=["onClick"],P=["onClick"],T=i("a",{style:{cursor:"pointer"}},"删除",-1);var q=e({__name:"Category",setup(e){const p=a(null),g=v(),m=r(),f=t({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",level:1,parent_id:0});b((()=>{q()})),_((()=>{console.log(f.pageSize)}));const S=g.afterEach((e=>{["category","level2","level3"].includes(e.name)&&q()}));h((()=>{S()}));const q=()=>{const{level:e=1,parent_id:a=0}=m.query;f.loading=!0,d.get("/categories",{params:{pageNumber:f.currentPage,pageSize:f.pageSize,categoryLevel:e,parentId:a}}).then((r=>{f.tableData=r.list,f.total=r.totalCount,f.currentPage=r.currPage,f.loading=!1,f.level=e,f.parentId=a}))},N=e=>{f.currentPage=e,q()},R=()=>{f.type="add",p.value.open()},U=e=>{f.multipleSelection=e},B=()=>{f.multipleSelection.length?d.delete("/categories",{data:{ids:f.multipleSelection.map((e=>e.categoryId))}}).then((()=>{u.success("删除成功"),q()})):u.error("请选择项")};return(e,a)=>{const r=y,t=k,m=C,v=x,b=w,_=I;return o(),l(_,{class:"category-container"},{header:n((()=>[i("div",z,[s(r,{type:"primary",icon:F(j),onClick:R},{default:n((()=>[c("增加")])),_:1},8,["icon"]),s(t,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:B},{reference:n((()=>[s(r,{type:"danger",icon:F(L)},{default:n((()=>[c("批量删除")])),_:1},8,["icon"])])),_:1})])])),default:n((()=>[s(v,{load:f.loading,ref:"multipleTable",data:f.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:U},{default:n((()=>[s(m,{type:"selection",width:"55"}),s(m,{prop:"categoryName",label:"分类名称"}),s(m,{prop:"categoryRank",label:"排序值",width:"120"}),s(m,{prop:"createTime",label:"添加时间",width:"200"}),s(m,{label:"操作",width:"220"},{default:n((e=>[i("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>{return r=e.row.categoryId,f.type="edit",void p.value.open(r);var r}},"修改",8,D),i("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>(e=>{const a=e.categoryLevel+1;4!=a?g.push({name:`level${a}`,query:{level:a,parent_id:e.categoryId}}):u.error("没有下一级")})(e.row)},"下级分类",8,P),s(t,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:a=>{return r=e.row.categoryId,void d.delete("/categories",{data:{ids:[r]}}).then((()=>{u.success("删除成功"),q()}));var r}},{reference:n((()=>[T])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["load","data"]),s(b,{background:"",layout:"prev, pager, next",total:f.total,"page-size":f.pageSize,"current-page":f.currentPage,onCurrentChange:N},null,8,["total","page-size","current-page"]),s(V,{ref_key:"addCate",ref:p,reload:q,type:f.type},null,8,["type"])])),_:1})}}},[["__file","/Users/gaobin/Downloads/vue3-admin-main/src/views/Category.vue"]]);export{q as default};
